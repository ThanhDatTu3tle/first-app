<div class="wrapper w-full h-fit bg-white p-5">
  <div class="title-btn-filter flex w-full align-items-center justify-content-between">
    <h1 class="text-3xl font-bold">WORKFOLLOW TASK LIST</h1>
  </div>
  <br />
  <p-breadcrumb class="max-w-full bg-white" [model]="items" [home]="home"></p-breadcrumb>

  <div class="wrapper-selector w-full flex mt-3 gap-2">
    <div class="flex flex-column w-full">
      <label>Month</label>
      <p-dropdown styleClass="w-full h-3rem mt-2" [options]="months" [(ngModel)]="selectedMonths" optionLabel="name"
        [filter]="true" filterBy="name" [showClear]="true" placeholder="Select month">
        <ng-template pTemplate="selectedItem" let-selectedOption>
          <div class="flex align-items-center gap-2">
            <div>{{ selectedOption.name }}</div>
          </div>
        </ng-template>
        <ng-template let-month pTemplate="item">
          <div class="flex align-items-center gap-2">
            <div>{{ month.name }}</div>
          </div>
        </ng-template>
      </p-dropdown>
    </div>

    <div class="flex flex-column w-full">
      <label>Employee</label>
      <p-dropdown styleClass="w-full h-3rem mt-2" [options]="users" [(ngModel)]="selectedUser"
        optionLabel="employee_name" [filter]="true" filterBy="employee_name" [showClear]="true"
        placeholder="Select employee">
        <ng-template pTemplate="selectedItem" let-selectedOption>
          <div class="flex align-items-center gap-2">
            <div>{{ selectedOption.employee_name }}</div>
          </div>
        </ng-template>
        <ng-template let-user pTemplate="item">
          <div class="flex align-items-center gap-2">
            <div>{{ user.employee_name }}</div>
          </div>
        </ng-template>
      </p-dropdown>
    </div>

    <div class="flex flex-column w-full">
      <label>Status</label>
      <p-dropdown styleClass="w-full h-3rem mt-2" [options]="status" [(ngModel)]="selectedStatus" optionLabel="name"
        [filter]="true" filterBy="name" [showClear]="true" placeholder="Select Status">
        <ng-template pTemplate="selectedItem" let-selectedOption>
          <div class="flex align-items-center gap-2">
            <div>{{ selectedOption.name }}</div>
          </div>
        </ng-template>
        <ng-template let-status pTemplate="item">
          <div class="flex align-items-center gap-2">
            <div>{{ status.name }}</div>
          </div>
        </ng-template>
      </p-dropdown>
    </div>

    <div class="flex flex-column w-full">
      <label>Testing Status</label>
      <p-dropdown styleClass="w-full h-3rem mt-2" [options]="testingStatus" [(ngModel)]="selectedTestingStatus"
        optionLabel="name" [filter]="true" filterBy="name" [showClear]="true" placeholder="Select Testing Status">
        <ng-template pTemplate="selectedItem" let-selectedOption>
          <div class="flex align-items-center gap-2">
            <div>{{ selectedOption.name }}</div>
          </div>
        </ng-template>
        <ng-template let-testingStatus pTemplate="item">
          <div class="flex align-items-center gap-2">
            <div>{{ testingStatus.name }}</div>
          </div>
        </ng-template>
      </p-dropdown>
    </div>

    <div class="flex flex-column w-full">
      <label>Tag</label>
      <input type="text" class="h-3rem mt-2" placeholder="Frontend, Backend, UXUI..." pInputText
        [(ngModel)]="valueTag" />
    </div>

    <div class="flex flex-column w-full">
      <label>Task ID</label>
      <input type="text" class="h-3rem mt-2" placeholder="Task ID" pInputText [(ngModel)]="valueTaskID" />
    </div>
  </div>

  <div class="wrapper-statistical flex flex-row justify-content-between gap-3 mt-3">
    <div class="w-3 h-fit surface-200 border-round-sm border-primary-500 p-3 cursor-pointer">
      <div class="card mb-0">
        <div class="flex flex-row align-items-center justify-content-between w-full">
          <div class="flex w-fit align-items-center justify-content-between">
            <i class="pi pi-bookmark text-blue-500 text-2xl pr-2"></i>
            <span class="block text-color text-2xl font-bold">Task</span>
          </div>
          <div
            class="flex w-4rem h-4rem border-circle border-primary-500 border-solid align-items-center justify-content-center">
            <p class="text-4xl">{{ tasklists.length }}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="w-3 h-fit bg-primary-100 border-round-sm border-primary-500 p-3 cursor-pointer">
      <div class="card mb-0">
        <div class="flex flex-row align-items-center justify-content-between w-full">
          <div class="flex w-fit align-items-center justify-content-between">
            <i class="pi pi-chart-line text-blue-500 text-2xl pr-2"></i>
            <span class="block text-color text-2xl font-bold">Task in process</span>
          </div>
          <div
            class="flex w-4rem h-4rem border-circle border-primary-500 border-solid align-items-center justify-content-center">
            <p class="text-4xl">{{ taskInProcess.length }}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="w-3 h-fit bg-yellow-300 border-round-sm border-primary-500 p-3 cursor-pointer">
      <div class="card mb-0">
        <div class="flex flex-row align-items-center justify-content-between w-full">
          <div class="flex w-fit align-items-center justify-content-between">
            <i class="pi pi-info-circle text-yellow-600 text-2xl pr-2"></i>
            <span class="block text-yellow-700 text-2xl font-bold">SL Bug</span>
          </div>
          <div
            class="flex w-4rem h-4rem border-circle border-yellow-600 border-solid align-items-center justify-content-center">
            <p class="text-4xl">{{ slBug.length }}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="w-3 h-fit bg-red-400 border-round-sm border-primary-500 p-3 cursor-pointer">
      <div class="card mb-0">
        <div class="flex flex-row align-items-center justify-content-between w-full">
          <div class="flex w-fit align-items-center justify-content-between">
            <i class="pi pi-stopwatch text-red-600 text-2xl pr-2"></i>
            <span class="block text-red-600 text-2xl font-bold">SL Task late</span>
          </div>
          <div
            class="flex w-4rem h-4rem border-circle border-red-600 border-solid align-items-center justify-content-center">
            <p class="text-4xl">{{ slTaskLate.length }}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="w-3 h-fit surface-200 border-round-sm border-primary-500 p-3 cursor-pointer">
      <div class="card mb-0">
        <div class="flex flex-row align-items-center justify-content-between w-full">
          <div class="flex w-fit align-items-center justify-content-between">
            <i class="pi pi-user text-blue-500 text-2xl pr-2"></i>
            <span class="block text-color text-xl font-bold">Employee in process</span>
          </div>
          <div
            class="flex w-4rem h-4rem border-circle border-primary-500 border-solid align-items-center justify-content-center">
            <p class="text-4xl">{{ employeeInProcess.length }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="wrapper-tasklist w-full mt-3">
    <div class="wrapper-header flex flex-row w-full align-items-center justify-content-between">
      <h2 class="text-2xl font-bold">Task list</h2>
      <div class="options flex flex-row align-items-center justify-content-between gap-2">
        <p-button label="Create task" icon="pi pi-plus"></p-button>
        <p-button label="Refresh" icon="pi pi-refresh"></p-button>
        <p-button label="Raw data" icon="pi pi-file-excel"></p-button>
      </div>
    </div>

    <div class="wrapper-table flex flex-column w-full mt-2">
      <!-- ToDo table -->
      <p-table [value]="taskInToDo" [tableStyle]="{ 'min-width': '50rem' }">
        <ng-template pTemplate="header">
          <tr>
            <th>{{ taskInToDo[0].status }}</th>
            <th>Task name</th>
            <th>Start date</th>
            <th>End date</th>
            <th>Main day</th>
            <th>Created by</th>
            <th>Tag</th>
            <th>Assignee</th>
            <th>Edit</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-taskInToDo>
          <tr>
            <td>
              <p class="w-fit h-fit surface-200 border-round-lg border-primary-500 p-2">#{{ taskInToDo.task_id }}</p>
            </td>
            <td>{{ taskInToDo.task_name }}</td>
            <td>
              <div class="flex gap-2">
                <i class="pi pi-clock"></i>
                <i class="pi pi-flag-fill" style="color: red;"></i>
                {{ taskInToDo.start_date }}
              </div>
            </td>
            <td>
              <div class="flex gap-3">
                <i class="pi pi-arrow-right" style="color: green; font-size: 1.2rem;"></i>
                {{ taskInToDo.end_date }}
              </div>
            </td>
            <td>
              <p class="w-fit h-fit bg-green-500 border-round-lg border-green-500 p-2 text-white">
                {{ taskInToDo.main_day }} day</p>
            </td>
            <td>{{ taskInToDo.created_by_name }}</td>
            <td>    
              <p class="w-fit h-fit bg-yellow-300 border-round-sm border-primary-500 p-2 gap-2" *ngFor="let item of taskInToDo.tag.slice(0, -1).split(', ')">{{ item }}</p>  
              <!-- <p class="bg-yellow-300 border-round-sm border-primary-500 p-2 gap-1">{{ taskInToDo.tag.slice(0, -1).split(', ') }}</p> -->
            </td>
            <td><img src="{{ taskInToDo.image }}" alt="avatar" class="w-3rem h-3rem border-circle"></td>
            <td><i class="pi pi-ellipsis-v"></i></td>
          </tr>
        </ng-template>
      </p-table>

      <!-- Develop table -->
      <p-table [value]="taskInProcess" [tableStyle]="{ 'min-width': '50rem' }">
        <ng-template pTemplate="header">
          <tr>
            <th>{{ taskInProcess[0].status }}</th>
            <th>Task name</th>
            <th>Start date</th>
            <th>End date</th>
            <th>Main day</th>
            <th>Created by</th>
            <th>Tag</th>
            <th>Assignee</th>
            <th>Edit</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-taskInProcess>
          <tr>
            <td>
              <p class="w-fit h-fit surface-200 border-round-lg border-primary-500 p-2">#{{ taskInProcess.task_id }}</p>
            </td>
            <td>{{ taskInProcess.task_name }}</td>
            <td>
              <div class="flex gap-2">
                <i class="pi pi-clock"></i>
                <i class="pi pi-flag-fill" style="color: red;"></i>
                {{ taskInProcess.start_date }}
              </div>
            </td>
            <td>
              <div class="flex gap-3">
                <i class="pi pi-arrow-right" style="color: green; font-size: 1.2rem;"></i>
                {{ taskInProcess.end_date }}
              </div>
            </td>
            <td>
              <p class="w-fit h-fit bg-green-500 border-round-lg border-green-500 p-2 text-white">
                {{ taskInProcess.main_day }} day</p>
            </td>
            <td>{{ taskInProcess.created_by_name }}</td>
            <td>{{ taskInProcess.tag }}</td>
            <td><img src="{{ taskInProcess.image }}" alt="avatar" class="w-3rem h-3rem border-circle"></td>
            <td><i class="pi pi-ellipsis-v"></i></td>
          </tr>
        </ng-template>
      </p-table>

      <!-- Completed table -->
    </div>
  </div>
</div>
